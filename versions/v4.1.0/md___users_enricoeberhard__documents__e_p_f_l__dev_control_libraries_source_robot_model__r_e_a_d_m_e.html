<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Control Libraries: Robot Model</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Control Libraries
   &#160;<span id="projectnumber">4.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Robot Model </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The <code><a class="el" href="namespacerobot__model.html" title="Robot kinematics and dynamics. ">robot_model</a></code> library is a wrapper for the <a href="https://github.com/stack-of-tasks/pinocchio">Pinocchio</a> library, used to compute dynamics model of a robot. It is specifically designed to work seamlessly with the <code><a class="el" href="namespacestate__representation.html" title="Core state variables and objects. ">state_representation</a></code> library, offering conversion functions between the states and input/output needed for <code>pinocchio</code>.</p>
<h2>Table of contents:</h2>
<ul>
<li><a href="#model-initialization">Model initialization</a></li>
<li><a href="#robot-kinematics">Robot kinematics</a></li>
<li><a href="#robot-dynamics">Robot dynamics</a></li>
</ul>
<h2>Model initialization</h2>
<p>The library offers a single class <code>Model</code> that encapsulates most of the functionalities from <code>pinocchio</code>, as well as extra functions. A <code>Model</code> is defined by a robot name, and initialized from a <code>URDF</code> description file of the robot.</p>
<div class="fragment"><div class="line"><a class="code" href="classrobot__model_1_1_model.html">robot_model::Model</a> model(<span class="stringliteral">&quot;myrobot&quot;</span>, <span class="stringliteral">&quot;path/to/urdf/myrobot.urdf&quot;</span>)</div></div><!-- fragment --><p>At creation, it uses the parser from <code>pinocchio</code> to read the <code>URDF</code> file and fill the needed parameters for computation.</p>
<h2>Robot kinematics</h2>
<p>Most common robotics functionalities are implemented such <code>forward_kinematics</code>, <code>inverse_kinematics</code>, <code>forward_velocity,</code>inverse_velocity`, ...</p>
<div class="fragment"><div class="line"><span class="comment">// forward kinematics: pose of end-effector frame from the robot joint positions</span></div><div class="line"><a class="code" href="classstate__representation_1_1_joint_positions.html">state_representation::JointPositions</a> jp = <a class="code" href="classstate__representation_1_1_joint_positions.html#aa57ddca4ebb17ec9b867e29acf2a63cc">state_representation::JointPositions::Random</a>(<span class="stringliteral">&quot;myrobot&quot;</span>, 7);</div><div class="line"><a class="code" href="classstate__representation_1_1_cartesian_pose.html">state_representation::CartesianPose</a> pose = model.forward_kinematics(jp);</div><div class="line"><span class="comment">// inverse kinematics: joint positions from end-effector pose</span></div><div class="line"><a class="code" href="classstate__representation_1_1_cartesian_pose.html">state_representation::CartesianPose</a> cp = <a class="code" href="classstate__representation_1_1_cartesian_pose.html#aeb83b9e4a6e9fba8f8d7651696f1ec24">state_representation::CartesianPose::Random</a>(<span class="stringliteral">&quot;eef&quot;</span>);</div><div class="line"><a class="code" href="classstate__representation_1_1_joint_positions.html">state_representation::JointPositions</a> jp = model.inverse_kinematics(cp);</div><div class="line"><span class="comment">// forward velocity kinematics: twist of end-effector frame from the robot joint velocities and positions</span></div><div class="line"><a class="code" href="classstate__representation_1_1_joint_state.html">state_representation::JointState</a> js = <a class="code" href="classstate__representation_1_1_joint_state.html#a2939ab85acce8605260589f376d4ffa9">state_representation::JointState::Random</a>(<span class="stringliteral">&quot;myrobot&quot;</span>, 7);</div><div class="line"><a class="code" href="classstate__representation_1_1_cartesian_twist.html">state_representation::CartesianTwist</a> twist = model.forward_velocity(js);</div><div class="line"><span class="comment">// inverse velocity kinematics: joint velocities from end-effector twist and current state of the robot</span></div><div class="line"><a class="code" href="classstate__representation_1_1_cartesian_twist.html">state_representation::CartesianTwist</a> ct = <a class="code" href="classstate__representation_1_1_cartesian_twist.html#a66d6821fbb85857c8917a13576eaa138">state_representation::CartesianTwist::Random</a>(<span class="stringliteral">&quot;eef&quot;</span>);</div><div class="line"><a class="code" href="classstate__representation_1_1_joint_positions.html">state_representation::JointPositions</a> jp = <a class="code" href="classstate__representation_1_1_joint_positions.html#aa57ddca4ebb17ec9b867e29acf2a63cc">state_representation::JointPositions::Random</a>(<span class="stringliteral">&quot;myrobot&quot;</span>, 7);</div><div class="line"><a class="code" href="classstate__representation_1_1_joint_velocities.html">state_representation::JointVelocities</a> jv = model.inverse_velocity(ct, jp);</div></div><!-- fragment --><p>All of those functions check for inconsistencies between the model and the inputs (incompatibility of joints, frame non existent in the robot model, ...). Thus, they can be called on other frames than the end-effector (which is the default value), or even vector of frames for bulk operations.</p>
<div class="fragment"><div class="line"><span class="comment">// pose of multiple robot frames from the robot joint positions</span></div><div class="line"><a class="code" href="classstate__representation_1_1_joint_positions.html">state_representation::JointPositions</a> jp = <a class="code" href="classstate__representation_1_1_joint_positions.html#aa57ddca4ebb17ec9b867e29acf2a63cc">state_representation::JointPositions::Random</a>(<span class="stringliteral">&quot;myrobot&quot;</span>, 7);</div><div class="line"><span class="keyword">auto</span> poses = model.forward_kinematics(jp, std::vector&lt;std::string&gt;{<span class="stringliteral">&quot;joint2&quot;</span>, <span class="stringliteral">&quot;eef_link&quot;</span>});</div></div><!-- fragment --><p>The Jacobian of the robot can also be computed and stored in the <code><a class="el" href="classstate__representation_1_1_jacobian.html" title="Class to define a robot Jacobian matrix. ">state_representation::Jacobian</a></code> wrapper:</p>
<div class="fragment"><div class="line"><a class="code" href="classstate__representation_1_1_joint_positions.html">state_representation::JointPositions</a> jp = <a class="code" href="classstate__representation_1_1_joint_positions.html#aa57ddca4ebb17ec9b867e29acf2a63cc">state_representation::JointPositions::Random</a>(<span class="stringliteral">&quot;myrobot&quot;</span>, 7);</div><div class="line"><a class="code" href="classstate__representation_1_1_jacobian.html">state_representation::Jacobian</a> = model.compute_jacobian(jp);</div></div><!-- fragment --><p>It can also be computed on lower frames than the end-effector, returning then a subset of the matrix, where non used joints are filled with 0 values.</p>
<div class="fragment"><div class="line"><a class="code" href="classstate__representation_1_1_joint_positions.html">state_representation::JointPositions</a> jp = <a class="code" href="classstate__representation_1_1_joint_positions.html#aa57ddca4ebb17ec9b867e29acf2a63cc">state_representation::JointPositions::Random</a>(<span class="stringliteral">&quot;myrobot&quot;</span>, 7);</div><div class="line"><a class="code" href="classstate__representation_1_1_jacobian.html">state_representation::Jacobian</a> = model.compute_jacobian(jp, <span class="stringliteral">&quot;joint3&quot;</span>);</div></div><!-- fragment --><h2>Robot dynamics</h2>
<p>Dynamic modeling of the robot is available within <code>pinocchio</code> and allows the computation of the gravity, coriolis, and inertia torques as well as their matrix counterpart.</p>
<div class="fragment"><div class="line"><span class="comment">// inertia matrix from joint positions</span></div><div class="line"><a class="code" href="classstate__representation_1_1_joint_positions.html">state_representation::JointPositions</a> jp = <a class="code" href="classstate__representation_1_1_joint_positions.html#aa57ddca4ebb17ec9b867e29acf2a63cc">state_representation::JointPositions::Random</a>(<span class="stringliteral">&quot;myrobot&quot;</span>, 7);</div><div class="line">Eigen::MatrixXd inertia = model.compute_inertia_matrix(jp);</div><div class="line"><span class="comment">// inertia torques, equivalent to inertia multiplied by joint accelerations. The joint positions part of the state</span></div><div class="line"><span class="comment">// is used to compute the inertia matrix</span></div><div class="line"><a class="code" href="classstate__representation_1_1_joint_state.html">state_representation::JointState</a> js = <a class="code" href="classstate__representation_1_1_joint_state.html#a2939ab85acce8605260589f376d4ffa9">state_representation::JointState::Random</a>(<span class="stringliteral">&quot;myrobot&quot;</span>, 7);</div><div class="line"><a class="code" href="classstate__representation_1_1_joint_torques.html">state_representation::JointTorques</a> inertia_t = model.compute_inertia_torques(js);</div><div class="line"></div><div class="line"><span class="comment">// coriolis matrix from joint positions and velocities</span></div><div class="line"><a class="code" href="classstate__representation_1_1_joint_state.html">state_representation::JointState</a> js = <a class="code" href="classstate__representation_1_1_joint_state.html#a2939ab85acce8605260589f376d4ffa9">state_representation::JointState::Random</a>(<span class="stringliteral">&quot;myrobot&quot;</span>, 7);</div><div class="line">Eigen::MatrixXd coriolis = model.compute_coriolis_matrix(js);</div><div class="line"><span class="comment">// coriolis torques, equivalent to coriolis multiplied by joint velocities. The joint positions part of the state</span></div><div class="line"><span class="comment">// is used to compute the coriolis matrix</span></div><div class="line"><a class="code" href="classstate__representation_1_1_joint_state.html">state_representation::JointState</a> js = <a class="code" href="classstate__representation_1_1_joint_state.html#a2939ab85acce8605260589f376d4ffa9">state_representation::JointState::Random</a>(<span class="stringliteral">&quot;myrobot&quot;</span>, 7);</div><div class="line"><a class="code" href="classstate__representation_1_1_joint_torques.html">state_representation::JointTorques</a> coriolis_t = model.compute_coriolis_torques(js);</div><div class="line"></div><div class="line"><span class="comment">// gravity torques from joint positions</span></div><div class="line"><a class="code" href="classstate__representation_1_1_joint_positions.html">state_representation::JointPositions</a> jp = <a class="code" href="classstate__representation_1_1_joint_positions.html#aa57ddca4ebb17ec9b867e29acf2a63cc">state_representation::JointPositions::Random</a>(<span class="stringliteral">&quot;myrobot&quot;</span>, 7);</div><div class="line"><a class="code" href="classstate__representation_1_1_joint_torques.html">state_representation::JointTorques</a> gravity_t = model.compute_gravity_torques(jp);</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
