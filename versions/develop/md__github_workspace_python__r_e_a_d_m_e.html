<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Control Libraries: Python Bindings</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Control Libraries<span id="projectnumber">&#160;6.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Python Bindings </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >This directory defines Python bindings for the control libraries.</p>
<h1>Installation</h1>
<p >You must first install <code>control-libraries</code> before you can install the Python bindings. Refer to the installation instructions in the top-level <a class="el" href="index.html#md__github_workspace_README">README</a> for more information.</p>
<p >Additionally, the installation of the bindings requires the following prerequisites:</p><ul>
<li><code>python3</code> &gt;= 3.0</li>
<li><code>pip3</code> &gt;= 10.0.0</li>
</ul>
<p >The installation itself is then quite straightforward: </p><div class="fragment"><div class="line">git clone https://github.com/epfl-lasa/control-libraries</div>
<div class="line"> </div>
<div class="line">## install control-libraries (skip this stage if already done)</div>
<div class="line">sudo control-libraries/source/install.sh</div>
<div class="line"> </div>
<div class="line">## install protocol (skip this stage if already done or not desired)</div>
<div class="line">sudo control-libraries/protocol/install.sh</div>
<div class="line"> </div>
<div class="line">## install the bindings using the pip installer</div>
<div class="line">pip3 install control-libraries/python</div>
</div><!-- fragment --><p >If the installation fails, it may be because of non-default installation directories for some dependencies. In this case, the include path for OSQP and OpenRobots can be set through environment variables before the pip install. </p><div class="fragment"><div class="line">export OSQP_INCLUDE_DIR=&#39;/path/to/include/osqp&#39;  # default /usr/local/include/osqp</div>
<div class="line">export OPENROBOTS_INCLUDE_DIR=&#39;/path/to/openrobots/include&#39;  # default /opt/openrobots/include</div>
<div class="line">pip3 install control-libraries/python</div>
</div><!-- fragment --><p >The example above installs the module to the default dist-packages location. You can see more information about the installed module using <code>pip3 show control-libraries</code>.</p>
<p >The process also works with Python virtual environments. For example, with <code>pipenv</code>: </p><div class="fragment"><div class="line">## pip3 install pipenv</div>
<div class="line"> </div>
<div class="line">pipenv install control-libraries/python</div>
</div><!-- fragment --><p >Once installed, you can simply import the module with an optional short alias: </p><div class="fragment"><div class="line"><span class="comment">#!/usr/bin/env python</span></div>
<div class="line"><span class="keyword">import</span> state_representation <span class="keyword">as</span> sr</div>
<div class="line"><span class="keyword">import</span> dynamical_systems</div>
<div class="line"> </div>
<div class="line">print(sr.__version__)</div>
<div class="line">print(dynamical_systems.__version__)</div>
<div class="line"> </div>
<div class="line">A = sr.CartesianState().Random(<span class="stringliteral">&quot;A&quot;</span>)</div>
<div class="line">print(A)</div>
</div><!-- fragment --><p >Or, directly import specific classes from the module. </p><div class="fragment"><div class="line"><span class="comment">#!/usr/bin/env python</span></div>
<div class="line"><span class="keyword">from</span> state_representation <span class="keyword">import</span> JointState</div>
<div class="line"><span class="keyword">from</span> dynamical_systems <span class="keyword">import</span> create_cartesian_ds, DYNAMICAL_SYSTEM_TYPE</div>
<div class="line"> </div>
<div class="line">B = JointState().Random(<span class="stringliteral">&quot;B&quot;</span>, 3)</div>
<div class="line">ds = create_cartesian_ds(DYNAMICAL_SYSTEM_TYPE.POINT_ATTRACTOR)</div>
</div><!-- fragment --><p >If the <code>clproto</code> C++ library is installed, the installation steps above will automatically install the <code>clproto</code> Python module which can be used to encode and decode objects into bytes of serialized data. </p><div class="fragment"><div class="line"><span class="comment">#!/usr/bin/env python</span></div>
<div class="line"><span class="keyword">from</span> state_representation <span class="keyword">import</span> JointState</div>
<div class="line"><span class="keyword">import</span> clproto</div>
<div class="line"> </div>
<div class="line">B = JointState().Random(<span class="stringliteral">&quot;B&quot;</span>, 3)</div>
<div class="line">encoded_msg = <a class="code hl_function" href="namespaceclproto.html#abf7d863ec82b8eab41a5078446652628">clproto.encode</a>(B, clproto.MessageType.JOINT_STATE_MESSAGE)</div>
<div class="line"> </div>
<div class="line">decoded_object = <a class="code hl_function" href="namespaceclproto.html#a6e069b963d40b003f87e9a3d7822df18">clproto.decode</a>(encoded_msg)</div>
<div class="ttc" id="anamespaceclproto_html_a6e069b963d40b003f87e9a3d7822df18"><div class="ttname"><a href="namespaceclproto.html#a6e069b963d40b003f87e9a3d7822df18">clproto::decode</a></div><div class="ttdeci">T decode(const std::string &amp;msg)</div><div class="ttdoc">Decode a serialized binary string from wire format into a control libraries object instance.</div></div>
<div class="ttc" id="anamespaceclproto_html_abf7d863ec82b8eab41a5078446652628"><div class="ttname"><a href="namespaceclproto.html#abf7d863ec82b8eab41a5078446652628">clproto::encode</a></div><div class="ttdeci">std::string encode(const T &amp;obj)</div><div class="ttdoc">Encode a control libraries object into a serialized binary string representation (wire format).</div></div>
</div><!-- fragment --><h1>About</h1>
<p ><a href="https://PyBind11.readthedocs.io/en/stable/index.html">PyBind11</a> is used to generate Python bindings for the classes and functions in control libraries.</p>
<p >The generated package is named <code>control-libraries</code>, but contains specific modules for importing. These are named the same as the standard modules of control libraries (e.g. <code><a class="el" href="namespacestate__representation.html" title="Core state variables and objects.">state_representation</a></code>).</p>
<p >The contents of the <a href="./source"><code>source</code></a> directory define the bindings between each Python module and the respective C++ library. The source files to bind each module are contained within a subdirectory of the same name.</p>
<p >The <code>setup.py</code> and <code>pyproject.toml</code> files are used to configure the build and installation of the Python bindings. The <code>.toml</code> file allows <code>pip</code> to automatically fetch the installation dependencies (namely <code>setuptools</code> and <code>pybind11</code>) in a temporary cache, allowing the subsequent <code>setup.py</code> to be evaluated without needing a local installation of <code>pybind11</code>. This feature requires a <a href="https://pypi.org/project/pip/"><code>pip</code></a> version 10.0 or newer.</p>
<p >The <a href="./test"><code>test</code></a> directory contains some Python scripts that import and check the bindings using the Python <code>unittest</code> framework. They are not currently comprehensive.</p>
<h1>Dockerfile</h1>
<p >A Dockerfile and run script are provided to test the installation of the bindings.</p>
<p >The docker image installs the core control libraries and subsequently installs the python bindings.</p>
<p >The <a href="./run.sh"><code>run.sh</code></a> script will build the docker image and launch an interactive container with the test files in the <a href="./test"><code>test</code></a> directory copied to the local path.</p>
<p >The run script tries to the clone the current local git branch when installing the control libraries in the Dockerfile. If the local branch does not exist on the remote, or if you want to test the python bindings against a difference control libraries source branch, you can supply a specific branch as the first argument to the run script. For example, <code>./run.sh develop</code> to use the <code>develop</code> branch.</p>
<p >You can run a single test with <code>python &lt;test_name.py&gt;</code>, or just enter a python shell with <code>python</code>. Run all tests with <code>python -m unittest discover &lt;path_to_test_dir&gt;</code>, or just <code>python -m unittest</code> if the <a href="./test"><code>test</code></a> directory in your current working directory. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
